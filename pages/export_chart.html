<div class="overlay-container">
    <div class="overlay">
        <div style="display: flex; justify-content: center; margin-top: calc(50vh - 59px); font-weight: bold; font-size: 22px;">
            <button class="w3-btn w3-white" onclick="exportAll()">Export In Excel</button>
        </div>
        <!-- Tables -->
        <div id="tableList" class="margin-auto chart-box">
            <!-- Debitors -->
            <table class="w3-table-all chart-tables">
                <thead>
                    <tr class="main-bg-color">
                        <th>ID</th>
                        <th>Party Code</th>
                        <th>Party Name</th>
                        <th>Party Type</th>
                        <th>Propritor Name</th>
                        <th>Mobile</th>
                        <th>Email</th>
                        <th>Address</th>
                        <th ng-hide="!(begBalPer.$value == 1 || userInfo.uc)">Beginning Balance</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="rec in debitors | orderBy : 'code' track by $index">
                        <td>{{$index + 1}}</td>
                        <td>{{rec.code}}</td>
                        <td>
                            <a href="#debitorledger?code={{rec.code}}&name={{rec.name}}&email={{rec.email}}" style="color: blue; cursor: pointer;">{{rec.name}}</a>
                        </td>
                        <td>{{rec.cusType}}</td>
                        <td>{{rec.recProprietor}}</td>
                        <td>{{rec.mobile}}</td>
                        <td>{{rec.email}}</td>
                        <td>{{rec.address}}</td>
                        <td ng-hide="!(begBalPer.$value == 1 || userInfo.uc)">{{comNum(rec.balance)}}</td>
                    </tr>
                </tbody>
            </table>
            <!-- Creditors -->
            <table class="w3-table-all chart-tables">
                <thead>
                    <tr class="main-bg-color">
                        <th>ID</th>
                        <th>Party Code</th>
                        <th>Party Name</th>
                        <th>Party Type</th>
                        <th>Propritor Name</th>
                        <th>Mobile</th>
                        <th>Email</th>
                        <th>Address</th>
                        <th ng-hide="!(begBalPer.$value == 1 || userInfo.uc)">Beginning Balance</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="pay in creditors | orderBy : 'code' track by $index">
                        <td>{{$index + 1}}</td>
                        <td>{{pay.code}}</td>
                        <td>
                            <a href="#creditorledger?code={{pay.code}}&name={{pay.name}}&email={{pay.email}}" style="color: blue; cursor: pointer;">{{pay.name}}</a>
                        </td>
                        <td>{{pay.partyType}}</td>
                        <td>{{pay.proprietor}}</td>
                        <td>{{pay.mobile}}</td>
                        <td>{{pay.email}}</td>
                        <td>{{pay.address}}</td>
                        <td ng-hide="!(begBalPer.$value == 1 || userInfo.uc)">{{comNum(pay.balance)}}</td>
                    </tr>
                </tbody>
            </table>
            <!-- Company Heads -->
            <table class="w3-table-all chart-tables">
                <thead>
                    <tr class="main-bg-color">
                        <th>ID</th>
                        <th>A/C Code</th>
                        <th>Party Name</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="ch in companyHeads | orderBy : 'code' track by $index">
                        <td>{{$index + 1}}</td>
                        <td>{{ch.code}}</td>
                        <td>{{ch.name}}</td>
                    </tr>
                </tbody>
            </table>
            <!-- Vehicles -->
            <table class="w3-table-all chart-tables">
                <thead>
                    <tr class="main-bg-color">
                        <th>ID</th>
                        <th>Code</th>
                        <th>Vehicle Type</th>
                        <th>Vehicle No</th>
                        <th ng-hide="!(begBalPer.$value == 1 || userInfo.uc)">Beginning Balance</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="Tr in vechicles | orderBy : 'code' track by $index">
                        <td>{{$index + 1}}</td>
                        <td>{{Tr.code}}</td>
                        <td>{{Tr.type}}</td>
                        <td>{{Tr.name}}</td>
                        <td ng-hide="!(begBalPer.$value == 1 || userInfo.uc)">{{comNum(Tr.balance)}}</td>
                    </tr>
                </tbody>
            </table>
            <!-- Employees -->
            <table class="w3-table-all chart-tables">
                <thead>
                    <tr class="main-bg-color">
                        <th>ID</th>
                        <th>Code</th>
                        <th>Name</th>
                        <th>Employee Type</th>
                        <th>Posting</th>
                        <th>Designation</th>
                        <th>Salary</th>
                        <th ng-hide="!(begBalPer.$value == 1 || userInfo.uc)">Beginning Balance</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="emp in employees | orderBy : 'code' track by $index">
                        <td>{{$index + 1}}</td>
                        <td>{{emp.code}}</td>
                        <td>{{emp.name}}</td>
                        <td>{{emp.type}}</td>
                        <td>{{emp.post}}</td>
                        <td>{{emp.des}}</td>
                        <td>{{comNum(emp.salary)}}</td>
                        <td ng-hide="!(begBalPer.$value == 1 || userInfo.uc)">{{comNum(emp.balance)}}</td>
                    </tr>
                </tbody>
            </table>
            <!-- Banks -->
            <table class="w3-table-all chart-tables">
                <thead>
                    <tr class="main-bg-color">
                        <th>ID</th>
                        <th>Code</th>
                        <th>Name</th>
                        <th>Account No</th>
                        <th ng-hide="!(begBalPer.$value == 1 || userInfo.uc)">Beginning Balance</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="bank in banks | orderBy : 'code' track by $index">
                        <td>{{$index + 1}}</td>
                        <td>{{bank.code}}</td>
                        <td>{{bank.name}}</td>
                        <td>{{bank.accno}}</td>
                        <td name="num" ng-hide="!(begBalPer.$value == 1 || userInfo.uc)">{{comNum(bank.balance)}}</td>
                    </tr>
                </tbody>
            </table>
            <!-- Contractors -->
            <table class="w3-table-all chart-tables">
                <thead>
                    <tr class="main-bg-color">
                        <th>ID</th>
                        <th>Code</th>
                        <th>Name</th>
                        <th>Contract</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="con in contractors | orderBy : 'code' track by $index">
                        <td>{{$index + 1}}</td>
                        <td>{{con.code}}</td>
                        <td>{{con.name}}</td>
                        <td>{{con.contact}}</td>
                    </tr>
                </tbody>
            </table>
            <!-- Raw Materials -->
            <table class="w3-table-all chart-tables">
                <thead>
                    <tr class="main-bg-color">
                        <th>ID</th>
                        <th>Code</th>
                        <th>Name</th>
                        <th>Primary Unit</th>
                        <th>Primary Quantity</th>
                        <th>Primary Unit Price</th>
                        <th>Primary Total Price</th>
                        <th>stad Unit</th>
                        <th>Stand Quantity</th>
                        <th>Stand Unit Price</th>
                        <th>Standard Total Price</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="paddyRaw in rawMaterials | orderBy : 'code' track by $index">
                        <td>{{$index + 1}}</td>
                        <td>{{paddyRaw.code}}</td>
                        <td>{{paddyRaw.name}}</td>
                        <td>{{paddyRaw.priUnit}}</td>
                        <td>{{comNum(paddyRaw.priQu)}}</td>
                        <td>{{comNum(paddyRaw.priUnitPri)}}</td>
                        <td>{{comNum(paddyRaw.priTotalPri)}}</td>
                        <td>{{paddyRaw.stdUnit}}</td>
                        <td>{{comNum(paddyRaw.stdQu)}}</td>
                        <td>{{comNum(paddyRaw.stdUnitPri)}}</td>
                        <td>{{comNum(paddyRaw.totalPri)}}</td>
                    </tr>
                </tbody>
            </table>
            <!-- Finished Goods -->
            <table class="w3-table-all chart-tables">
                <thead>
                    <tr class="main-bg-color">
                        <th>ID</th>
                        <th>Code</th>
                        <th>Name</th>
                        <th>Std unit</th>
                        <th>Pack Size</th>
                        <th>Number Of pack</th>
                        <th>Total quantity</th>
                        <th>Std unit price</th>
                        <th>Total price</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="rice in finGoods | orderBy : 'code' track by $index">
                        <td>{{$index + 1}}</td>
                        <td>{{rice.code}}</td>
                        <td>{{rice.name}}</td>
                        <td>{{rice.stdUnit}}</td>
                        <td>{{comNum (rice.packSize)}}</td>
                        <td>{{comNum (rice.noPack)}}</td>
                        <td>{{comNum (rice.totalQu)}}</td>
                        <td>{{comNum (rice.stdUnitPri)}}</td>
                        <td>{{comNum (rice.totalPri)}}</td>
                    </tr>
                </tbody>
            </table>
            <!-- By Products -->
            <table class="w3-table-all chart-tables">
                <thead>
                    <tr class="main-bg-color">
                        <th>ID</th>
                        <th>Code</th>
                        <th>Name</th>
                        <th>Std unit</th>
                        <th>Pack Size</th>
                        <th>Number Of pack</th>
                        <th>Total quantity</th>
                        <th>Std unit price</th>
                        <th>Total price</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="byProduct in byProducts | orderBy : 'code' track by $index">
                        <td>{{$index + 1}}</td>
                        <td>{{byProduct.code}}</td>
                        <td>{{byProduct.name}}</td>
                        <td>{{byProduct.stdUnit}}</td>
                        <td>{{comNum (byProduct.packSize)}}</td>
                        <td>{{comNum (byProduct.noPack)}}</td>
                        <td>{{comNum (byProduct.totalQu)}}</td>
                        <td>{{comNum (byProduct.stdUnitPri)}}</td>
                        <td>{{comNum (byProduct.totalPri)}}</td>
                    </tr>
                </tbody>
            </table>
            <!-- Loans -->
            <table class="w3-table-all chart-tables">
            <thead>
                <tr class="main-bg-color">
                    <th>ID</th>
                    <th>Code</th>
                    <th>Loan No.</th>
                    <th>Loan Type</th>
                    <th>Loan Nature</th>
                    <th ng-hide="!(begBalPer.$value == 1 || userInfo.uc)">Beginning Balance</th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="paddyDry in loans | orderBy : 'code' track by $index">
                    <td>{{$index + 1}}</td>
                    <td>{{paddyDry.code}}</td>
                    <td>{{paddyDry.name}}</td>
                    <td>{{paddyDry.type}}</td>
                    <td>{{paddyDry.nature}}</td>
                    <td ng-hide="!(begBalPer.$value == 1 || userInfo.uc)">{{comNum(paddyDry.balance)}}</td>
                </tr>
            </tbody>
            </table>
            <!-- cost centre -->
            <table class="w3-table-all chart-tables">
                <thead>
                    <tr class="main-bg-color">
                        <th>ID</th>
                        <th>Cost Center</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="costCenter in costCenters | orderBy : 'code' track by $index">
                        <td>{{$index + 1}}</td>
                        <td>{{costCenter.$value}}</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <!-- End of the Journy -->
    </div>
</div>
<script>
    $("#tableList").hide();
    function exportAll() {
        $print("print");
        var debitors = XLSX.utils.table_to_sheet($js('debitors'), { cellDates: true });
        // var creditors = XLSX.utils.table_to_sheet($js('creditors'), { cellDates: true });
        // var companyHeads = XLSX.utils.table_to_sheet($js('companyHeads'), { cellDates: true });
        // var vechicles = XLSX.utils.table_to_sheet($js('vechicles'), { cellDates: true });
        // var employees = XLSX.utils.table_to_sheet($js('employees'), { cellDates: true });
        // var banks = XLSX.utils.table_to_sheet($js('banks'), { cellDates: true });
        // var contractors = XLSX.utils.table_to_sheet($js('contractors'), { cellDates: true });
        // var rawMaterials = XLSX.utils.table_to_sheet($js('rawMaterials'), { cellDates: true });
        // var finGoods = XLSX.utils.table_to_sheet($js('finGoods'), { cellDates: true });
        // var byProducts = XLSX.utils.table_to_sheet($js('byProducts'), { cellDates: true });
        // var loans = XLSX.utils.table_to_sheet($js('loans'), { cellDates: true });
        // var costCenters = XLSX.utils.table_to_sheet($js('costCenters'), { cellDates: true });
        // var wscols = [
        //     { wch: 4 },
        //     { wch: 12 },
        //     { wch: 20 },
        //     { wch: 20 },
        //     { wch: 14 },
        //     { wch: 40 }
        // ];
        // var wsrows = [
        //     {
        //         hpx: 24,
        //         level: 2
        //     }
        // ];
        // ws['!cols'] = wscols;
        // ws['!rows'] = wsrows;
        XLSX.utils.book_append_sheet(wb, debitors, 'Banks');
        var wbout = XLSX.write(wb, { bookType: 'xlsx', bookSST: true, type: 'binary' });
        function s2ab(s) {
            var buf = new ArrayBuffer(s.length);
            var view = new Uint8Array(buf);
            for (var i = 0; i < s.length; i++) view[i] = s.charCodeAt(i) & 0xFF;
            return buf;
        }
        saveAs(new Blob([s2ab(wbout)], { type: "application/octet-stream" }), 'Charts_Export.xlsx');
    }
</script>