<div class="overlay-container">
    <div class="overlay">
        <div style="display: flex; justify-content: center; margin-top: calc(50vh - 59px); font-weight: bold; font-size: 22px;">
            <button class="w3-btn w3-white" onclick="exportAll()">Export In Excel</button>
        </div>
        <!-- Tables -->
        <div id="bank" class="margin-auto chart-box">
            <!-- Debitors -->
            <!-- Creditors -->
            <!-- Company Heads -->
            <!-- Vehicles -->
            <!-- Employees -->
            <!-- Banks -->
            <table class="w3-table-all chart-tables">
                <thead>
                    <tr class="main-bg-color">
                        <th>ID</th>
                        <th>Code</th>
                        <th>Name</th>
                        <th>Account No</th>
                        <th ng-hide="!(begBalPer.$value == 1 || userInfo.uc)">Beginning Balance</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="bank in banks | orderBy : 'code' track by $index">
                        <td>{{$index + 1}}</td>
                        <td>{{bank.code}}</td>
                        <td>{{bank.name}}</td>
                        <td>{{bank.accno}}</td>
                        <td name="num" ng-hide="!(begBalPer.$value == 1 || userInfo.uc)">{{comNum(bank.balance)}}</td>
                    </tr>
                </tbody>
            </table>
            <!-- Contractors -->
            <!-- Raw Materials -->
            <!-- Finished Goods -->
            <!-- Byp Products -->
            <!-- Loans -->
        </div>
        <!-- End of the Journy -->
    </div>
</div>
<script>
    // $("#tableList").hide();
    function exportAll() {
        $print("print");
        var ws = XLSX.utils.table_to_sheet($js('bank'), { cellDates: true });
        // var wscols = [
        //     { wch: 4 },
        //     { wch: 12 },
        //     { wch: 20 },
        //     { wch: 20 },
        //     { wch: 14 },
        //     { wch: 40 }
        // ];
        // var wsrows = [
        //     {
        //         hpx: 24,
        //         level: 2
        //     }
        // ];
        // ws['!cols'] = wscols;
        // ws['!rows'] = wsrows;
        XLSX.utils.book_append_sheet(wb, ws, 'Banks');
        var wbout = XLSX.write(wb, { bookType: 'xlsx', bookSST: true, type: 'binary' });
        function s2ab(s) {
            var buf = new ArrayBuffer(s.length);
            var view = new Uint8Array(buf);
            for (var i = 0; i < s.length; i++) view[i] = s.charCodeAt(i) & 0xFF;
            return buf;
        }
        saveAs(new Blob([s2ab(wbout)], { type: "application/octet-stream" }), 'Charts_Export.xlsx');
    }
</script>